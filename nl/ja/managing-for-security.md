---

copyright:
  years: 2018, 2019
lastupdated: "2019-03-26"

keywords: IBM CIS, optimal security, Security Level

subcollection: cis

---

{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:DomainName: data-hd-keyref="DomainName"}
{:note: .note}
{:important: .important}
{:deprecated: .deprecated}
{:generic: data-hd-programlang="generic"}

# 最適なセキュリティーのための IBM CIS の管理
{:#manage-your-ibm-cis-for-optimal-security}
IBM Cloud Internet Services (CIS) のセキュリティー設定には、誤検出やトラフィックへの悪影響を回避するように設計された、安全なデフォルト値が含まれています。 ただし、これらの安全なデフォルト設定が、あらゆるお客様にとって最善のセキュリティー態勢になるとは限りません。 以下の手順を実行して、CIS アカウントが安全でセキュアな方法で構成されるようにしてください。

**推奨事項とベスト・プラクティス**

* プロキシー接続および不明化拡大により発信元 IP アドレスをセキュアにする
* セキュリティー・レベルを選択的に構成する
* Web アプリケーション・ファイアウォール (WAF) を安全にアクティブ化する

## ベスト・プラクティス 1: 発信元 IP アドレスをセキュアにする
{:#best-practice-secure-origin-ip-address}

IBM CIS を使用してサブドメインをプロキシー接続すると、応答は IBM CIS に固有の IP アドレスを使用してアクティブに行われるので、すべてのトラフィックが保護されます (例えば、すべてのクライアントはまず CIS プロキシーに接続されるので、発信元 IP アドレスが隠蔽されます)。

### 発信元からの HTTP(S) トラフィックの DNS レコードすべてに対して IBM CIS プロキシーを使用する
{:#use-cis-proxies-for-dns-records}

発信元 IP アドレスのセキュリティーを改善するには、すべての HTTP(S) トラフィックをプロキシー接続する必要があります。

**違いを確認してください - 非プロキシー接続レコードとプロキシー接続レコードの照会:**

```
$ dig nonproxied.theburritobot.com +short
1.2.3.4 (The origin IP address)

$ dig proxied.theburritobot.com +short
104.16.22.6 , 104.16.23.6 (CIS IP addresses)
```

### 非標準の名前を使用して非プロキシーの発信元レコードを隠蔽する
{:#obsure-non-proxied-origin-records-with-non-standard-names}
FTP など、IBM CIS でプロキシー接続することができず、依然として発信元 IP を使用しているレコードは、追加の不明化を作成して保護することができます。 特に、IBM CIS でプロキシー接続できない発信元のレコードが必要な場合は、非標準の名前を使用してください。 例えば、`ftp.example.com` ではなく `[random word or-random characters].example.com` を使用します。 この不明化により、DNS レコードの辞書スキャンが行われても、発信元 IP アドレスが露出する可能性は小さくなります。

### 可能であれば HTTP トラフィックと非 HTTP トラフィックとで異なる IP 範囲を使用する
{:#use-separate-ipranges-for-traffic}
一部のお客様は、HTTP トラフィックと非 HTTP トラフィックとで異なる IP 範囲を使用して、その HTTP IP 範囲を指し示すすべてのレコードをプロキシー接続できるように、そしてすべての非 HTTP トラフィックを異なる IP サブネットによって隠蔽できるようにしています。

## ベスト・プラクティス 2: セキュリティー・レベルを選択的に構成する
{:#best-practice-configure-security-level-selectively}
**セキュリティー・レベル**により、**IP レピュテーション・データベース**の機密性が設定されます。 悪い相互作用や誤検出を防止するためにも、ドメインごとに**セキュリティー・レベル**を構成して、それぞれの必要に応じてセキュリティーの程度を適切に調節してください。

### 機密性の高い領域のセキュリティー・レベルを高めて「高」にする
{:#increase-security-level-for-sensitive-areas}
総当たり攻撃の試行を減らすために、ドメインの「拡張セキュリティー (Advanced Security)」ページから、または管理ページやログイン・ページに**「ページ・ルール」**を追加することにより、この設定値を高くすることができます。

1. API の URL パターン (`www.example.com/wp-login` など) を使用して**「ページ・ルール (Page Rule)」**を作成します。 
2. **「セキュリティー・レベル (Security Level)」**設定を識別します。
3. 設定に**「高」**のマークを付けます。
4. **「リソースのプロビジョン (Provision Resource)」**を選択します。

### 誤検出を削減するために機密ではないパスや API のセキュリティー・レベルを低くする
{:#decrease-security-level-non-sensitive-paths-reduce-false-positives}
以下の方法で、一般ページや API トラフィックに対しては、この設定値を低く設定することができます。 

1. API の URL パターン (`www.example.com/api/*` など) を使用して**「ページ・ルール (Page Rule)」**を作成します。
2. **「セキュリティー・レベル (Security Level)」**設定を識別します。
3. セキュリティー・レベルを**「低 (Low)」**または**「実質的にオフ (Essentially off)」**に切り替えます。
4. **「リソースのプロビジョン (Provision Resource)」**を選択します。

### 「セキュリティー・レベル (Security Level)」設定とは
{:#what-do-security-level-settings-mean}
「セキュリティー・レベル (Security Level)」設定は、特定の IP アドレスがネットワーク上での悪意のある動作により取得した脅威スコアと連動しています。 10 より大きい脅威スコアは「高」と認識されます。

* **高**: 0 より大きな脅威スコアが検査対象となります。
* **中**: 14 より大きな脅威スコアが検査対象となります。
* **低 (LOW)**: 24 より大きな脅威スコアが検査対象となります。
* **実質的にオフ (ESSENTIALLY OFF)**: 49 より大きな脅威スコアが検査対象となります。
* **オフ (OFF)**: *エンタープライズのみ* 
* **攻撃を受けている**: Web サイトが DDoS 攻撃を受けている場合にのみ使用します。訪問者にはインタースティシャル・ページが約 5 秒間表示され、その間に CIS がトラフィックと動作を分析して、許可された訪問者が Web サイトにアクセスしようとしていることを確認します。**「攻撃を受けている」**は、API の使用など、ドメイン上の一部のアクションに影響を与えることがあります。そのセクションのページ・ルールを作成することにより、API やドメインの他のいずれかの部分にカスタム・セキュリティー・レベルを設定できます。

セキュリティー・レベルの設定値は、定期的に確認することをお勧めします。その手順については、[CIS セットアップのベスト・プラクティスの資料](/docs/infrastructure/cis?topic=cis-best-practices-for-cis-setup)を参照してください。

## ベスト・プラクティス 3: Web アプリケーション・ファイアウォール (WAF) を安全にアクティブ化する
{:#best-practice-activate-waf-safely}
WAF は、**セキュリティー**のセクションで設定できます。 ドメイン全体に対してオンにする前に、WAF が可能な限り安全に設定されるようにするため、これらの設定値について逆の順序で説明します。 これらの初期設定では、**セキュリティー・イベント**にデータを追加して詳細にチューニングすることにより、誤検出を減らすことができます。新しい脆弱性が識別されると、WAF はそれに対応できるように自動的に更新されます。

WAF は、以下のタイプの攻撃からの保護を提供します。
* SQL インジェクション攻撃
* クロスサイト・スクリプティング
* クロスサイト・フォージェリー

WAF には、最も一般的な攻撃を止めるためのルールが含まれた、デフォルトのルール・セットが含まれています。 現時点では、WAF ルール・セットを有効または無効にして、WAF ルール・セット内の特定のルールを詳細に調整できます。デフォルトのルール・セットと各ルールの動作について詳しくは、[WAF のデフォルト・ルール・セット](/docs/infrastructure/cis?topic=cis-waf-default-rule-set)の資料を参照してください。

WAF について詳しくは、[WAF 概念の資料](/docs/infrastructure/cis?topic=cis-web-application-firewall-concepts-q-a)を参照してください。

## ベスト・プラクティス 4: TLS 設定を構成する
{:#best-practice-configure-tls-settings}
IBM CIS には、トラフィックを暗号化するためのいくつかのオプションが備わっています。 リバース・プロキシーとして、データ・センターで TLS 接続を閉じてから、発信元サーバーへの新しい TLS 接続を開きます。

TLS には、4 つの操作モードが備わっています。
* **オフ**: このモードでは TLS が無効になります。これは推奨されていません。
* **クライアントとエッジ間 (Client-to-edge)**: CIS からクライアントへのトラフィックは TLS で暗号化されますが、CIS から発信元サーバーへのトラフィックは TLS で暗号化されません。
* **終端間でフレキシブル (End-to-end flexible)**: すべてのトラフィックが TLS で暗号化されます。ただし、CIS と発信元サーバーの間のトラフィックは、自己署名証明書を使用して保護することができます。
* **終端間で CA 署名付き (End-to-end CA signed)**: すべてのトラフィックが TLS で暗号化されます。CA 署名付きの証明書を使用する必要があります。

TLS のオプションについて詳しくは、[この資料](/docs/infrastructure/cis?topic=cis-tls-options)を参照してください。

IBM CIS では、カスタムの証明書を使用することができます。あるいは、CIS によってユーザー用にプロビジョンされたワイルドカードを使用することもできます。

### カスタム証明書のアップロード
{:#upload-custom-certs}
**「証明書の追加」**ボタンをクリックして、証明書、秘密鍵、およびバンドル方式を入力することにより、カスタムの証明書をアップロードできます。お客様独自の証明書をアップロードした場合は、暗号化トラフィックとの互換性が直ちに得られ、証明書 (例えば Extended Validation (EV) 証明書) に対する管理を維持することになります。 カスタム証明書をアップロードした場合は証明書の管理が必要になるということに注意してください。 例えば、IBM CIS は証明書の有効期限を追跡しません。 

![カスタムの証明書](images/upload-custom-certificate.png)

### 専用証明書の注文
{:#order-dedicated-certs}
CIS は専用証明書を提供して、証明書の管理を容易にします。秘密鍵の生成、証明書署名要求 (CSR) の作成、証明書を忘れずに更新することなどは必要なくなります。**「証明書の追加」**ボタンをクリックして、ワイルドカード証明書を注文するかまたはホスト名を入力して専用カスタム証明書を注文することにより、専用証明書を注文できます。証明書のタイプは以下のとおりです。

 * SHA-2/ECDSA 署名付き証明書 (P-256 鍵を使用)、 
 * SHA-2/RSA 署名付き証明書 (RSA 2048 ビット鍵を使用)、および 
 * SHA-1/RSA 署名付き証明書 (RSA 2048 ビット鍵を使用)。 
 
CIS は、`.cu`、`.iq`、`.ir`、`.kp`、`.sd`、`.ss`、および `.ye` を除く、すべての TLD に対して発行できます。CIS は有効期限を管理します。専用カスタム証明書のホスト名を編集するには、再注文してから削除する必要があります。例えば、ホスト名 `alpha.yourdomain.com` の専用カスタム証明書を注文したとします。ホスト名 `beta.yourdomain.com` を専用カスタム証明書に追加するには、ホスト名 `alpha.yourdomain.com` および `beta.yourdomain.com` の、別の専用カスタム証明書を注文します。その後、元の専用カスタム証明書を削除_しなければなりません_。

初めて専用の証明書を注文する際に、ドメイン制御検証 (DCV) プロセスが実行され、対応する TXT レコードが生成されます。TXT レコードを削除すると、別の専用証明書の注文時に再度 DCV プロセスが実行されます。専用の証明書を削除しても、DCV プロセスに対応する TXT レコードは削除されません。
{:note}

以下は、専用証明書を注文するときに生じることのある一般的なエラーです。
* `証明書サービスに接続する際のエラー。`
* `証明書サービスから要求する際のエラー。`
{:note}

証明書を注文する際にエラーを受け取った場合は、ページを最新表示して再試行してください。

![専用証明書](images/order-dedicated-certificate.png)

### プロビジョンされた証明書を利用する
{:#utilize-provisioned-certificate}
IBM は、お客様にドメインのワイルドカード証明書を提供する複数の認証局 (CA) とパートナー関係を結んでいます。 これらの証明書をセットアップするには、手動での検証が必要となることがあります。 これらの追加ステップを実行する際には、サポート・チームの支援を受けることができます。

### エッジでの証明書の優先順位
{:#certificate-prioirity-at-our-edge}
エッジで証明書が表示されるときの優先順位は以下のとおりです。
1. アップロードされたカスタム
2. 専用カスタム
3. 専用ワイルドカード
4. 汎用

### 最小 TLS バージョン
{:#security-minimum-tls-version}
[最小 TLS バージョン](/docs/infrastructure/cis?topic=cis-tls-options#minimum-tls-version)を参照してください。TLS のレベルが高いとセキュリティーも高くなりますが、顧客がサイトに接続することが妨げられる可能性もあります。

---

copyright:
  years: 2018, 2019
lastupdated: "2019-03-14"

keywords: health checks, origin pools, load balancers, IBM CIS

subcollection: cis

---

{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:DomainName: data-hd-keyref="DomainName"}
{:note: .note}
{:important: .important}
{:deprecated: .deprecated}
{:generic: data-hd-programlang="generic"}


# ロード・バランサーのセットアップと構成
{:#set-up-and-configure-your-load-balancers}
 
 IBM CIS は、グローバル・ロード・バランシングをサービスとして提供しています。 GLB ダッシュボードは以下のように表示されます。

![イメージ](images/glb-screen.png)

## GLB ダッシュボード
{:#glb-dashboard}

ダッシュボードには、ロード・バランサー、起点プール、ヘルス・チェックを示す 3 つのリストが表示されます。リストには、新規または更新されたグローバル・ロード・バランサーまたはそのコンポーネントの 1 つが、プロビジョンまたは更新された後に表示されます。 リストは最初は空です。ロード・バランサーを作成するには、いくつかの操作を実行する必要があります。

必要な作業について既に知っている場合には、[クイック・スタート・ガイド](/docs/infrastructure/cis?topic=cis-global-load-balancer-quick-setup)を参照してください。

### 作成
{:#create-health-check}

<sup>`*`</sup> は、その手順がオプションであることを示しています。
{:note}

1) <sup>`*`</sup>ヘルス・チェックを作成します。**「ヘルス・チェックの作成」**をクリックしてください。
  ![イメージ](images/glb-health-check-list.png)
    <ul>
      <li><b>パス</b>: ヘルス・チェックの対象にするエンドポイント・パス。</li> 
      <li><b>タイプ</b>: ヘルス・チェックに使用するプロトコル。</li>
      <li><b>説明</b>: ユーザー指定の説明。</li>
    </ul>

2) プールを作成します。**「プールの作成」**をクリックしてください。
  ![イメージ](images/glb-pool-list.png)
    <ul>
      <li><b>正常性</b>: プールの状況。</li>
      <li><b>名前</b>: ユーザー指定の名前。</li>
      <li><b>起点</b>: プール内の正常な起点の数。</li>
      <li><b>ヘルス・チェック</b>: 付加されたヘルス・チェックのパス (存在する場合)。</li>
    </ul>

3) ロード・バランサーを作成します。**「ロード・バランサーを作成します」**をクリックしてください。
  ![イメージ](images/glb-load-balancer-list.png)
    <ul>
      <li><b>正常性</b>: ロード・バランサーの状況。</li>
      <li><b>ホスト名</b>: ドメイン名の前に付加する名前。</li>
      <li><b>使用可能なプール</b>: 正常なプールの数。</li>
      <li><b>TTL</b>: 存続時間。</li>
      <li><b>プロキシー</b>: トラフィック・フローの中継を有効または無効にします。</li>
      <li><b>状況</b>: ロード・バランサーを有効または無効にします。</li>
    </ul>

IBM の地理的な地域は Cloudflare の地域とは異なります。Cloudflare で使用される地理的な地域について詳しくは、[Load Balancing: Geographic Regions ![外部リンク・アイコン](../../icons/launch-glyph.svg "外部リンク・アイコン")](https://support.cloudflare.com/hc/en-us/articles/115000540888-Load-Balancing-Geographic-Regions){:new_window} を参照してください。  
{:note}

### 編集/削除
{:#edit-delete-load-balancer}
ロード・バランサーまたはそのコンポーネントの 1 つを編集または削除するには、各行の右端にあるオーバーフロー・メニュー・ボタンをクリックします。

オーバーフロー・メニュー・ボタンを以下に示します。

![イメージ](images/overflow.png)

リストごとに以下のオプションが用意されています。

* ヘルス・チェック
    * **ヘルス・チェックの表示**: このオプションは、ヘルス・チェックの簡潔な要約を表示して、編集フローに移動するためのリンクを示します。
    * **ヘルス・チェックの編集**: このオプションは、ユーザーを編集フローにリダイレクトします。 
    * **ヘルス・チェックの削除**: このオプションは、削除フローの確認ダイアログ・ボックスを表示します。

* プール
    * **プール詳細の表示**: このオプションは、プールの情報を含むモーダルなダイアログ・ボックスを表示します。
    * **プールの編集**: このオプションは、ユーザーを編集フローにリダイレクトします。
    * **プールの削除**: このオプションは、削除フローの確認ダイアログ・ボックスを表示します。

* ロード・バランサー
    * **無効化/有効化 (Disable/Enable)**: ロード・バランサーを有効または無効にします。
    * **ロード・バランサーの編集**: 編集フローにリダイレクトします。 
    * **ロード・バランサーの削除**: 削除フローの確認ダイアログ・ボックスを表示します。

## ヘルス・チェックの追加
{:#add-a-health-check}

ヘルス・チェックは、起点プールに対するオプションの付加機能です。このチェックは、プールの正常性をモニターするために、カスタムの繰り返し間隔を使用して、特定の応答本文または状況コードが返されるかどうかを調べます。 作成したヘルス・チェックは、新規または既存の起点プールに追加できます。

ヘルス・チェックを作成するときの必須フィールドは以下の 1 つだけです。
 * **応答コード (Reponse Code)**: ヘルス・チェックで予期する HTTP 応答コードまたはコード範囲。 「x」で表すワイルドカードを使用して、200 から 299 までの値を指定する必要があります。

オプションの追加フィールド
 * **パス**: ヘルス・チェックの実行対象のエンドポイント・パス (デフォルトは /)。
 * **タイプ**: ヘルス・チェックに使用するプロトコル (デフォルトは HTTP)。
 * **説明**: ヘルス・チェックの説明。
 * **間隔**: ヘルス・チェックの実行間隔 (秒単位)。 間隔を短くすると、フェイルオーバー時間は向上しますが、複数の場所でチェックを行うので起点に対する負荷は増加します (デフォルトは 60)。
 * **メソッド**: ヘルス・チェックに使用する HTTP メソッド (デフォルトは GET)。
 * **タイムアウト**: ヘルス・チェックに失敗のマークを付けるまでの時間 (秒) (デフォルトは 5)。
 * **再試行**: タイムアウトが発生した場合に、起点に非正常のマークを付けるまでに再試行する回数。再試行は即時に実行されます (デフォルトは 2)。
 * **応答本文**: 応答本文で照合する大/小文字を区別しないサブストリング。 このストリングが検出されない場合、起点には非正常のマークが付けられます。
 * **要求ヘッダー**: ヘルス・チェックで送信する HTTP 要求ヘッダー。 デフォルトでホスト・ヘッダーを設定することをお勧めします。 `User-Agent` ヘッダーは、オーバーライドできません。

## プールの追加
{:#add-a-pool}

プロビジョンしたロード・バランサーごとに、少なくとも 1 つのプールが必要です。 プールとは、ロード・バランサーで使用する起点をグループ化したものです。

プールを作成するときの必須フィールドは以下の 2 つです。
 * **名前**: プールの短縮名 (タグ)。 英数字、ハイフン、下線のみを使用できます。
 * **起点**: このプールに含める起点のリスト。 このプールに向けて送信されたトラフィックは、プール自体が正常であれば、現在正常なすべての起点の間で分散されます。

オプションの追加フィールド
 * **説明**: 人間が理解できるプールの説明。
 * **有効**: このプールを有効 (デフォルト) にするかどうか。 無効にしたプールは、トラフィックを受信せず、ヘルス・チェックから除外されます。 プールを無効にすると、そのプールを使用するロード・バランサーは、次のプール (存在する場合) にフェイルオーバーします (デフォルトは真)。
 * **正常な起点のしきい値**: このプールでトラフィックを処理するために必要とする正常な起点の最小数。正常な起点の数がこの数を下回ると、プールに非正常のマークが付けられ、次に使用可能なプールにフェイルオーバーされます (デフォルトは 1)。
 * **ヘルス・チェック地域 (Health Check Regions)**: モニターを実行するヘルス・チェックの地域。 **注**: IBM の地理的な地域は Cloudflare の地域とは異なります。Cloudflare で使用される地理的な地域について詳しくは、[Load Balancing: Geographic Regions ![外部リンク・アイコン](../../icons/launch-glyph.svg "外部リンク・アイコン")](https://support.cloudflare.com/hc/en-us/articles/115000540888-Load-Balancing-Geographic-Regions){:new_window} を参照してください。 
 * **ヘルス・チェック**: このプールに含まれている起点を検査するために使用するヘルス・チェック (デフォルトはヘルス・チェックなし)。
 * **通知 E メール**: 正常性状況の通知を受け取る E メール・アドレス。このアドレスは、1 人のメールボックスにすることも、メーリング・リストにすることもできます。

## ロード・バランサーの追加
{:#add-a-load-balancer}

ロード・バランサーは、中継するトラフィックを、ラウンドロビン分散を使用して複数の起点プールの間に分散させます。

ロード・バランサーを作成するときの必須フィールドを次に示します。
 * **名前**: ロード・バランサーに関連付ける DNS ホスト名。 このホスト名が IBM の DNS に DNS レコードとして既に存在する場合、ロード・バランサーが優先され、DNS レコードは使用されません。
 * **デフォルト・プール**: プール ID のリスト。フェイルオーバーの優先順にリストします。 ここに定義したプールがデフォルトで使用されます。つまり、特定の地域に地域プールが構成されていない場合に使用されます。

オプションで、以下のフィールドを構成できます。
 * **プロキシー**: IBM のパフォーマンスおよびメトリック・サービスを使用してトラフィックを転送します。
 * **セッション・アフィニティー**: 常に同じパフォーマンスおよびメトリック・インスタンスを使用して転送します。このオプションは、プロキシーを有効にした場合にのみ使用できます。
 * **TTL**: このロード・バランサーから返される IP アドレスの DNS エントリーの存続時間 (TTL)。 このオプションは、プロキシーしないロード・バランサーにのみ適用されます。その他の場合は、デフォルトで`「自動」`になります。
 * **地域プール**: 地域/国別コードから、特定の地域用のプール・リスト (フェイルオーバーの優先順のリスト) へのマッピング。地域が明示的に定義されていない場合は、デフォルトのプールを使用するようにフォールバックされます。**注**: IBM の地理的な地域は Cloudflare の地域とは異なります。Cloudflare で使用される地理的な地域について詳しくは、[Load Balancing: Geographic Regions ![外部リンク・アイコン](../../icons/launch-glyph.svg "外部リンク・アイコン")](https://support.cloudflare.com/hc/en-us/articles/115000540888-Load-Balancing-Geographic-Regions){:new_window} を参照してください。 
 
この文書で使用されている用語 (通常は業界全体で一般的に使用される用語です) の定義については、[用語集](/docs/infrastructure/cis?topic=cis-glossary)を参照してください。
